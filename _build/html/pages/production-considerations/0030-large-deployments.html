<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Large Scale Deployments &mdash; Fuel for OpenStack 3.0 documentation</title>
    
    <link rel="stylesheet" href="../../_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '3.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <link rel="top" title="Fuel for OpenStack 3.0 documentation" href="../../index.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li><a href="../../index.html">Fuel for OpenStack 3.0 documentation</a> &raquo;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Large Scale Deployments</a><ul>
<li><a class="reference internal" href="#certificate-signing-requests-and-puppet-master-cobbler-capacity">Certificate signing requests and Puppet Master/Cobbler capacity</a></li>
<li><a class="reference internal" href="#downloading-of-operating-systems-and-other-software">Downloading of operating systems and other software</a></li>
</ul>
</li>
</ul>

  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../../_sources/pages/production-considerations/0030-large-deployments.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="large-scale-deployments">
<h1>Large Scale Deployments<a class="headerlink" href="#large-scale-deployments" title="Permalink to this headline">¶</a></h1>
<p>When deploying large clusters &#8211; those of 100 nodes or more &#8211; there are two basic bottlenecks:</p>
<ul class="simple">
<li>Certificate signing requests and Puppet Master/Cobbler capacity</li>
<li>Downloading of operating systems and other software</li>
</ul>
<p>Careful planning is key to eliminating these potential problem areas, but there&#8217;s another way. If you are deploying Fuel 3.1 from the ISO, Fuel takes care of these problems through caching and orchestration. We feel, however, that it&#8217;s always good to have a sense of how to solve these problems should they appear.</p>
<div class="section" id="certificate-signing-requests-and-puppet-master-cobbler-capacity">
<h2>Certificate signing requests and Puppet Master/Cobbler capacity<a class="headerlink" href="#certificate-signing-requests-and-puppet-master-cobbler-capacity" title="Permalink to this headline">¶</a></h2>
<p>When deploying a large cluster, you may find that Puppet Master begins to have difficulty when you start exceeding 20 or more simultaneous requests. Part of this problem is because the initial process of requesting and signing certificates involves *.tmp files that can create conflicts.  To solve this problem, you have two options: reduce the number of simultaneous requests, or increase the number of Puppet Master/Cobbler servers.</p>
<p>The number of simultaneous certificate requests that are active can be controlled by staggering the Puppet agent run schedule.  This can be accomplished through orchestration.  You don&#8217;t need extreme staggering &#8211; 1 to 5 seconds will do &#8211; but if this method isn&#8217;t practical, you can increase the number of Puppet Master/Cobbler servers.</p>
<p>If you&#8217;re simply overwhelming the Puppet Master process and not running into file conflicts, one way to get around this problem is to use Puppet Master with Thin as the backend component and nginx as a front end component.  This configuration dynamically scales the number of Puppet Master processes to better accommodate changing load.</p>
<p>You can find sample configuration files for nginx and puppetmasterd at [CONTENT NEEDED HERE].</p>
<p>You can also increase the number of servers by creating a cluster that utilizes a round robin DNS configuration through a service like HAProxy. You will need to ensure that these nodes are kept in sync.  For Cobbler, that means a combination of the &#8211;replicate switch, XMLRPC for metadata, rsync for profiles and distributions.  Similarly, Puppet Master and PuppetDB can be kept in sync with a combination of rsync (for modules, manifests, and SSL data) and database replication.</p>
<img alt="../../_images/cobbler-puppet-ha.png" src="../../_images/cobbler-puppet-ha.png" />
</div>
<div class="section" id="downloading-of-operating-systems-and-other-software">
<h2>Downloading of operating systems and other software<a class="headerlink" href="#downloading-of-operating-systems-and-other-software" title="Permalink to this headline">¶</a></h2>
<p>Large deployments can also suffer from a bottleneck in terms of the additional traffic created by downloading software from external sources.  One way to avoid this problem is by increasing LAN bandwidth through bonding multiple gigabit interfaces.  You might also want to consider 10G Ethernet trunking between infrastructure switches using CAT-6a or fiber to improve backend speeds to reduce latency and provide more overall pipe.  (See &#8220;Sizing Hardware&#8221; for more information on choosing networking equipment.)</p>
<p>Another option is to prevent the need to download so much data in the first place using either apt-cacher to cache frequently downloaded packages or to set up a private repository. The downside of using your own repository, however, is that you have to spend more time manually updating it. Apt-cacher automates this process. To use apt-cacher, the kickstart that Cobbler sends to each node should specify Cobbler&#8217;s IP address and the apt-cacher port as the proxy server.  This will prevent all of the nodes from having to download the software individually.</p>
<p><a class="reference external" href="http://www.mirantis.com/contact/">Contact Mirantis</a> for information on creating a private repository.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li><a href="../../index.html">Fuel for OpenStack 3.0 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2013, Mirantis.
      Last updated on 2013/07/22.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2b1.
    </div>
  </body>
</html>